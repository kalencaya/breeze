<div class="da-list-wrap">
  <div class="da-content-wrapper">
    <da-layout-row [daGutter]="[24, 24]">
      <da-col-item [daSpan]="24" [daXs]="5" [daMm]="24">
        <d-card style="min-height: calc(100vh - 145px)">
          <da-layout-row class="d-card-header">
            <da-layout-col [daSpan]="24" style="vertical-align: middle">
              <d-card-header>
                <d-card-title>
                  <d-button-group>
                    <d-button (btnClick)="showRole()" [bsStyle]="roleBtnStyle">{{ 'admin.role' | translate }}</d-button>
                    <d-button (btnClick)="showDept()" [bsStyle]="deptBtnStyle">{{ 'admin.dept' | translate }}</d-button>
                  </d-button-group>
                </d-card-title>
              </d-card-header>
            </da-layout-col>
          </da-layout-row>
          <d-card-content>
            <ul class="list-group" *ngIf="tabId === roleTab">
              <li
                class="list-group-item"
                [ngClass]="{ selected: isRoleSelect(item) }"
                (click)="showPrivilegeByRole(item)"
                *ngFor="let item of roleList"
              >
                <span [ngClass]="{ 'li-disable': item.roleStatus.value != '1' }">{{ item.roleName + '&emsp;' }}</span>
              </li>
            </ul>
            <div *ngIf="tabId === deptTab" style="padding: 10px 0px 10px 0px">
              <d-search
                style="width: 100%; margin-bottom: 8px"
                [placeholder]="searchTip"
                [isKeyupSearch]="true"
                (searchFn)="searchDeptTree($event)"
              ></d-search>
              <d-operable-tree
                #operableTree
                [tree]="deptList"
                [treeNodeIdKey]="'deptId'"
                [treeNodeTitleKey]="'deptName'"
                [treeNodeChildrenKey]="'children'"
                [selectDisabledKey]="'disableSelect'"
                [draggable]="false"
                [checkable]="false"
                (nodeSelected)="showRoleByDept($event)"
              >
              </d-operable-tree>
            </div>
          </d-card-content>
        </d-card>
      </da-col-item>
      <da-col-item [daSpan]="24" [daXs]="19" [daMm]="24">
        <da-layout-row [daGutter]="[24, 24]" style="margin: -12px -12px -12px -18px">
          <da-col-item [daSpan]="24">
            <div class="da-list-container">
              <div class="list-content" id="privilegeContent" style="min-height: calc(100vh - 178px)">
                <d-tabs [type]="'tabs'" (activeTabChange)="activeTabChange($event)" *ngIf="tabId === roleTab">
                  <d-tab *ngFor="let item of tabItems" [id]="item.id" [tabId]="item.id">
                    <ng-template dTabTitle>
                      {{ item.title }}
                    </ng-template>
                    <ng-template dTabContent>
                      <d-search
                        style="margin-bottom: 8px; width: 100%"
                        [placeholder]="searchTip"
                        [isKeyupSearch]="true"
                        (searchFn)="searchPrivilegeTree($event)"
                      ></d-search>
                      <d-operable-tree
                        *ngIf="checkedItemId != 0"
                        #privilegeTree
                        [tree]="privilegeList"
                        [treeNodeIdKey]="'privilegeId'"
                        [treeNodeTitleKey]="'privilegeName'"
                        [treeNodeChildrenKey]="'children'"
                        [draggable]="false"
                        [checkable]="true"
                        [checkableRelation]="'both'"
                        (nodeChecked)="privilegeNodeChecked($event)"
                      >
                      </d-operable-tree>
                    </ng-template>
                  </d-tab>
                </d-tabs>
                <da-layout-row [daGutter]="[24, 24]" style="margin-top: -12px" *ngIf="tabId === deptTab">
                  <da-col-item [daSpan]="12">
                    <d-tabs [type]="'tabs'">
                      <d-tab title="待授权" id="deptGrant" tabId="deptGrant">
                        <ng-template dTabContent>
                          <d-button
                            bsStyle="common"
                            *ngFor="let item of grantRoleList"
                            style="margin-right: 8px"
                            (btnClick)="grantDeptRole(item)"
                            >{{ item.roleName }}</d-button
                          >
                        </ng-template>
                      </d-tab>
                    </d-tabs>
                  </da-col-item>
                  <da-col-item [daSpan]="12">
                    <d-tabs [type]="'tabs'" style="height: 50%">
                      <d-tab title="已授权" id="deptGranted" tabId="deptGranted">
                        <ng-template dTabContent>
                          <d-button
                            bsStyle="primary"
                            *ngFor="let item of grantedRoleList"
                            style="margin-right: 8px"
                            (btnClick)="revokeDeptRole(item)"
                            >{{ item.roleName }}</d-button
                          >
                        </ng-template>
                      </d-tab>
                    </d-tabs>
                  </da-col-item>
                </da-layout-row>

                <!-- <ul class="list-group" *ngIf="tabId === deptTab">
                  <li
                    class="list-group-item"
                    [ngClass]="{ selected: isRoleSelect(item) }"
                    (click)="showPrivilegeByRole(item)"
                    *ngFor="let item of roleList"
                  >
                    <span [ngClass]="{ 'li-disable': item.roleStatus.value != '1' }">{{ item.roleName + '&emsp;' }}</span>
                  </li>
                </ul> -->
              </div>
            </div>
          </da-col-item>
        </da-layout-row>
      </da-col-item>
    </da-layout-row>
  </div>
</div>
